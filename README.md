
# Модель восстановления пропущенных пробелов

### Цель работы
Создание и обучение модели, способной восстанавливать пропущенные пробелы в тексте.  

**Пример работы модели:**  
`"Этохорошаяработа,наверно"` → `"Это хорошая работа, наверно"`

---

### Анализ тестовых данных и сбор датасета
После анализа тестового файла было выявлено, что строки преимущественно состоят из объявлений или песен. Для обучения модели был собран датасет с аналогичной тематикой, состоящий из двух частей:  

1. **Фрагменты русской литературы**  
   Источник: [Complex Russian Dataset на Kaggle](https://www.kaggle.com/datasets/artalmaz31/complex-russian-dataset)  
   Файл: **books-B.txt**  

   Обработка: текст разделялся по пробелам, каждые 10 слов формировали новый элемент датасета.  
   **Первые 5 элементов:**
   ```text
   ['В смысле они улетели? с неимоверным удивлением спрашиваю у Арти,',
    'все еще не в силах поверить в это, слишком уж',
    'неожиданно и вообще странно как-то. В прямом, флот вышел в',
    'звездной системе недалеко от нас, предполагаю для корректировки курса, они',
    'так делают при прыжках на очень большие расстояния, а потом']

2. **Объявления с Авито**
   Источник: [Avito Data на Kaggle](https://www.kaggle.com/datasets/antonoof/avito-data)
   Файл: **train\_part\_0002.snappy.parquet**

   Из каждого объявления брались первые 12 слов.

В итоге датасет содержал **623,797 строк**.

---

### Обучение модели

Была дообучена модель **cointegrated/rubert-tiny2** с использованием полного fine-tuning.

* Количество эпох: 3
* Время обучения: \~1 час  (15 минут ушли на валидацию из-за слишком частой проверки)

**Результаты обучения (шаги, кратные 5000):**

| Step  | Training Loss | Validation Loss | F1       | Accuracy |
| ----- | ------------- | --------------- | -------- | -------- |
| 5000  | 0.099200      | 0.082076        | 0.912779 | 0.970503 |
| 10000 | 0.081100      | 0.066541        | 0.930397 | 0.976361 |
| 15000 | 0.074200      | 0.059333        | 0.938717 | 0.979042 |
| 20000 | 0.067400      | 0.054511        | 0.943711 | 0.980818 |
| 25000 | 0.062100      | 0.051527        | 0.947173 | 0.981969 |
| 30000 | 0.059900      | 0.049097        | 0.949670 | 0.982809 |
| 35000 | 0.058900      | 0.047376        | 0.951586 | 0.983439 |
| 40000 | 0.057900      | 0.046162        | 0.952994 | 0.983925 |
| 45000 | 0.055300      | 0.045101        | 0.954046 | 0.984289 |
| 50000 | 0.053600      | 0.044537        | 0.954752 | 0.984509 |
| 55000 | 0.055100      | 0.044193        | 0.955035 | 0.984606 |




